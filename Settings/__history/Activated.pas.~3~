unit Activated;

interface

uses uMainForm;

procedure FormActivated;

implementation

procedure FormActivated;
begin
  frmLogin.Tag := 0;
  frmLogin.ShowModal;

  if frmLogin.Tag = 0 then
  begin
    ShowMessage('Not logged in');
    // Application.Terminate;
  end
  else
  begin
    viUserStatus.ImageName := 'open';
    lbUserStatus.Caption := 'You are logged in, system activated';
    Self.Caption := 'SGLGB System | SEAL OF GOOD LOCAL GOVERNANCE FOR BARANGAY | 2024 | ' ;
    Login.Visible := False;
    LogOut.Visible := True;

    // Sidebar buttons
    btnDashboard.Enabled := True;
    btnDCF.Enabled := True;
    btnMOVs.Enabled := True;
    btnCalendar.Enabled := True;
    btnUsers.Enabled := True;

    // Page Control
    PageControl.Enabled := True;

    // Set Focus
    btnDashboard.SetFocus;
  end
end;

end.
